(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{249:function(e,t,a){"use strict";a.r(t);var n=a(10),r=a(11),i=a(13),o=a(12),s=a(14),c=a(0),l=a.n(c),u=a(17),d=a.n(u),m=(a(65),a(66),a(57)),p=a(15),h=a(52),f=a.n(h),g=a(53),v=a.n(g),b=a(7),E=a(4),y=(a(233),function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).state={date:""},a.handleClick=function(){a.props.history.push("/register")},a.returnRedOrGreenIcon=function(e){return Date.parse(e.ValidityPeriod.EndTime)<Date.parse(a.state.date)||"closed"===e.Progress?l.a.createElement("img",{src:f.a,id:"not_active",alt:"",height:"30",width:"30"}):l.a.createElement("img",{src:v.a,id:"active",alt:"",height:"30",width:"30"})},a.getType=function(e){return null!=e?"Networks"===Object.keys(e)[0]?"Linje":"StopPoints"===Object.keys(e)[0]?"Stopp":"VehicleJourneys"===Object.keys(e)[0]?"Avgang":"Error":"Error"},a.getDate=function(e){if(e){var t=e.match(/\d+/g),a=t[0].substring(2),n=t[1],r=t[2],i=t[3],o=t[4];return"".concat(i,":").concat(o,"  ").concat(r,".").concat(n,".").concat(a)}return"Ikke oppgitt"},a.edit=function(e){a.props.history.push("/edit/".concat(e.target.value))},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=(new Date).getDate();e<10&&(e="0"+e);var t=(new Date).getMonth()+1;t<10&&(t="0"+t);var a=(new Date).getFullYear(),n=(new Date).getHours();n<10&&(n="0"+n);var r=(new Date).getMinutes();r<10&&(r="0"+r);var i=(new Date).getSeconds();i<10&&(i="0"+i),this.setState({date:"".concat(a,"-").concat(t,"-").concat(e,"T").concat(n,":").concat(r,":").concat(i,"+02:00")})}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,l.a.createElement("div",{className:"register_box",id:"overview"},l.a.createElement("h2",{className:"text-center text-white"},"Oversikt"),l.a.createElement("br",null),l.a.createElement("div",null,l.a.createElement(b.Button,{variant:"secondary",onClick:this.handleClick,type:"button",className:"btn btn-warning btn-lg btn-block"},"Ny melding")),l.a.createElement("br",null),this.props.data.PtSituationElement&&l.a.createElement("div",{className:"table-responsive-md"},l.a.createElement(E.Table,{id:"dtOrderExample",className:"table table-striped table-light table-borderless table-hover",bgcolor:"#000000"},l.a.createElement(E.Thead,{className:"bg-primary"},l.a.createElement(E.Tr,{bgcolor:"#babbcf"},l.a.createElement(E.Th,{scope:"col"},l.a.createElement("b",null,"Status")),l.a.createElement(E.Th,{scope:"col"},l.a.createElement("b",null,"#")),l.a.createElement(E.Th,{scope:"col"},l.a.createElement("b",null,"Oppsommering")),l.a.createElement(E.Th,{scope:"col"},l.a.createElement("b",null,"Rapporttype")),l.a.createElement(E.Th,{scope:"col"},l.a.createElement("b",null,"Fra-dato")),l.a.createElement(E.Th,{scope:"col"},l.a.createElement("b",null,"Til-dato")),l.a.createElement(E.Th,{scope:"col"},l.a.createElement("b",null,"Type")),l.a.createElement(E.Th,{scope:"col"}))),l.a.createElement(E.Tbody,null,this.props.data.PtSituationElement.map(function(t,a){return l.a.createElement(E.Tr,{key:t.SituationNumber},l.a.createElement(E.Td,{className:"Status"},e.returnRedOrGreenIcon(t)),l.a.createElement(E.Td,{className:"#"},t.SituationNumber.split(":").pop()),l.a.createElement(E.Td,{className:"Melding",width:"25%"},t.Summary._text),l.a.createElement(E.Td,{className:"ReportType"},t.ReportType),l.a.createElement(E.Td,{className:"Fra-dato"},e.getDate(t.ValidityPeriod.StartTime)),l.a.createElement(E.Td,{className:"Til-dato"},e.getDate(t.ValidityPeriod.EndTime)),l.a.createElement(E.Td,{className:"Type"},e.getType(t.Affects)),l.a.createElement(E.Td,null,l.a.createElement(b.Button,{variant:"secondary",value:a,onClick:e.edit},"Endre")))}))))))}}]),t}(l.a.Component)),S=a(16),k=a(250).createApolloFetch,N="https://api.dev.entur.io/journey-planner/v2/graphql",T={method:"GET",headers:{accept:"application/json","ET-Client-Name":"entur - deviation-messages"}},w={getAuthorities:function(){return k({uri:N,headers:{"ET-client-Name":"entur - deviation-messages"}})({query:"\n      {\n        authorities{\n          id\n          name\n        }\n      } "}).catch(function(e){return e}).then(function(e){return e})},organisationID:function(e){fetch("https://api.staging.entur.io/organisations/v1/register/organisations/"+e,T).catch(function(e){return e}).then(function(e){return e})},getLines:function(e){return k({uri:N,headers:{"ET-client-Name":"entur - deviation-messages"}})({query:'\n      { \n        lines(authorities: "'.concat(e,'") { \n          name \n          id\n          quays {\n            id\n            name\n            stopPlace{\n              id\n            }\n          }\n        } \n      } ')}).catch(function(e){return e}).then(function(e){return e})},getDepartures:function(e,t,a){return k({uri:N,headers:{"ET-client-Name":"entur - deviation-messages"}})({query:'\n      { \n        serviceJourneys(authorities: "'.concat(e,'", lines: "').concat(t,'", activeDates: "').concat(a,'") { \n          id\n          estimatedCalls(date:"').concat(a,'") {\n            aimedDepartureTime\n            quay {\n              name\n              stopPlace {\n                id\n              }\n            }\n          }\n        }\n      }')}).catch(function(e){return e}).then(function(e){return e})}},D=(a(235),a(18)),x=a.n(D),C=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).state={date:"",dateShort:"",newAffect:"",searchBar:"",stops:"",departures:"",type:void 0,chosenLine:void 0,departure:void 0,checkbox:void 0,checkbox2:void 0,multiples:void 0,dateFromTo:void 0,message:void 0,submit:void 0,departureSok:void 0,counter:0,from:void 0},a.getIssuesCount=function(){return a.props.firebase.collection(a.props.organization).doc("SituationNumber").set({counter:a.state.counter}),a.state.counter},a.createNewIssue=function(e){return{CreationTime:a.state.date,ParticipantRef:a.props.organization.split(":")[0],SituationNumber:a.props.organization.split(":")[0]+":SituationNumber:"+a.getIssuesCount(),Source:{SourceType:"directReport"},Progress:"open",ValidityPeriod:null,Severity:"normal",ReportType:e.target.ReportType.value,Summary:{_attributes:{"xml:lang":"NO"},_text:e.target.oppsummering.value},Description:{_attributes:{"xml:lang":"NO"},_text:e.target.beskrivelse.value},Advice:{_attributes:{"xml:lang":"NO"},_text:e.target.forslag.value},Affects:[]}},a.createStops=function(){var e=[];a.props.lines.map(function(t){return e=e.concat(t.quays)}),a.setState({stops:e})},a.createNewLine=function(){return{Networks:{AffectedNetwork:{AffectedLine:{LineRef:a.state.chosenLine}}}}},a.createAffectedRoute=function(){return{StopPoints:{AffectedStopPoint:a.state.multipleStops.map(function(e){return{StopPointRef:e.value}})}}},a.createAffectedRouteLine=function(){return a.state.multipleStops.map(function(e){return{AffectedStopPoint:{StopPointRef:e.value}}})},a.createNewSpecifiedStops=function(){return{Networks:{AffectedNetwork:{AffectedLine:{LineRef:a.state.chosenLine,Routes:{AffectedRoute:{StopPoints:a.createAffectedRouteLine()}}}}}}},a.createAffectedDeparture=function(){return{VehicleJourneys:{AffectedVehicleJourney:{FramedVehicleJourneyRef:{DataFrameRef:document.getElementById("date").value,DatedVehicleJourneyRef:a.state.chosenLine},Route:null}}}},a.createNewSpecifiedStopsDeparture=function(){return{VehicleJourneys:{AffectedVehicleJourney:{FramedVehicleJourneyRef:{DataFrameRef:document.getElementById("date").value,DatedVehicleJourneyRef:a.state.chosenLine},Route:a.createAffectedRoute()}}}},a.handleClick=function(){a.props.history.push("/")},a.handleSubmit=function(e){var t=a.createNewIssue(e);if(""===e.target.beskrivelse.value&&delete t.Description,"departure"===a.state.type?t.ValidityPeriod={StartTime:e.target.date.value+"T00:00:00+02:00",EndTime:e.target.date.value+"T23:59:59+02:00"}:e.target.to.value?t.ValidityPeriod={StartTime:e.target.from.value.replace(" ","T")+":00+02:00",EndTime:e.target.to.value.replace(" ","T")+":00+02:00"}:t.ValidityPeriod={StartTime:e.target.from.value.replace(" ","T")+":00+02:00"},"line"===a.state.type)if(a.state.checkbox){var n=a.createNewSpecifiedStops();t.Affects=n}else{var r=a.createNewLine();t.Affects=r}if("stop"===a.state.type){var i=a.createAffectedRoute();t.Affects=i}if("departure"===a.state.type)if(a.state.checkbox2){var o=a.createNewSpecifiedStopsDeparture();t.Affects=o}else{var s=a.createAffectedDeparture();t.Affects=s}var c=a.props.data;c.PtSituationElement.push(t),a.props.firebase.collection(a.props.organization).doc("Issues").set(c),a.props.history.push("/")},a.handleChangeType=function(e){a.createStops(),a.state.departureSok&&a.setState({message:void 0}),a.setState({type:e.target.value,checkbox:void 0,checkbox2:void 0,chosenLine:void 0,departureSok:void 0,submit:void 0,departure:void 0}),"departure"===e.target.value&&a.setState({departure:!0,dateFromTo:void 0,message:void 0})},a.handleChangeLine=function(e){"departure"===a.state.type?a.setState({chosenLine:e.value}):a.setState({chosenLine:e.value,dateFromTo:!0,message:!0,submit:!0})},a.handleChangeDeparture=function(e){a.setState({chosenLine:e.value,message:!0,submit:!0})},a.handleChangeSpecifiedStops=function(e){a.setState({multipleStops:e,dateFromTo:!0,message:!0,submit:!0})},a.handleChangeSpecifyStopsLine=function(){!0===document.getElementById("gridCheck").checked?a.setState({checkbox:!0}):a.setState({checkbox:void 0})},a.handleChangeSpecifyStopsDeparture=function(){!0===document.getElementById("gridCheck2").checked?a.setState({checkbox2:!0}):a.setState({checkbox2:void 0})},a.handleChangeSpecifiedStopsDeparture=function(e){a.setState({multipleStops:e})},a.callApiDeparture=function(){var e=document.getElementById("date").value,t=a.state.chosenLine;w.getDepartures(a.props.orgID,t,e).then(function(e){a.setState({departures:e.data.serviceJourneys,departureSok:!0})})},a.updateFromDate=function(){a.setState({from:document.getElementById("from").value.replace(" ","T")})},a.returnMappedObjects=function(e){return e[0].stopPlace?e.map(function(e){return{label:e.name+" - "+e.stopPlace.id,value:e.stopPlace.id}}):e.map(function(e){return{label:e.name+" - "+e.id,value:e.id}})},a.returnSpecifiedLines=function(){var e=a.props.lines.find(function(e){return e.id===a.state.chosenLine});return e?a.returnMappedObjects(e.quays):[]},a.returnSpecifiedLinesDeparture=function(){var e=a.state.departures.find(function(e){return e.id===a.state.chosenLine});return e?e.estimatedCalls.map(function(e){return{label:e.quay.name+" - "+e.quay.stopPlace.id,value:e.quay.stopPlace.id}}):[]},a.returnServiceJourney=function(){return a.state.departures.map(function(e){return{label:e.estimatedCalls[0].aimedDepartureTime.split("T").pop().split(":00+")[0]+" fra "+e.estimatedCalls[0].quay.name+" ("+e.id+")",value:e.id}}).sort(function(e,t){return e.label>t.label?1:-1})},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=(new Date).getDate();t<10&&(t="0"+t);var a=(new Date).getMonth()+1;a<10&&(a="0"+a);var n=(new Date).getFullYear(),r=(new Date).getHours();r<10&&(r="0"+r);var i=(new Date).getMinutes();i<10&&(i="0"+i);var o=(new Date).getSeconds();o<10&&(o="0"+o),this.props.firebase.collection(this.props.organization).get().then(function(s){e.setState({date:"".concat(n,"-").concat(a,"-").concat(t,"T").concat(r,":").concat(i,":").concat(o,".000+02:00"),dateShort:"".concat(n,"-").concat(a,"-").concat(t,"T").concat(r,":").concat(i),counter:parseInt(s.docs[1].data().counter)+1})})}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("div",{className:"register_box",id:"small"},l.a.createElement("form",{className:"register",onSubmit:this.handleSubmit,autoComplete:"off"},l.a.createElement("h2",{className:"text-center text-white"},"Registrer ny melding"),l.a.createElement("br",null),l.a.createElement("div",{className:"choose_type"},l.a.createElement("p",{className:"text-center text-white"},"Velg linje, stopp eller avgang"),l.a.createElement("select",{className:"browser-default custom-select",defaultValue:"default",onChange:this.handleChangeType},l.a.createElement("option",{value:"default",disabled:!0}," "),l.a.createElement("option",{value:"line"},"Linje"),l.a.createElement("option",{value:"stop"},"Stopp"),l.a.createElement("option",{value:"departure"},"Avgang"))),this.props.lines&&l.a.createElement("div",{className:"choose_type"},("line"===this.state.type||"departure"===this.state.type)&&l.a.createElement(S.a,{placeholder:"Velg linje",onChange:this.handleChangeLine,options:this.returnMappedObjects(this.props.lines)}),"line"===this.state.type&&this.state.chosenLine&&l.a.createElement("div",{className:"form-check d-flex"},l.a.createElement("label",{className:"form-check-label",htmlFor:"gridCheck"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"gridCheck",value:"stops",onChange:this.handleChangeSpecifyStopsLine}),l.a.createElement("p",{className:"text-center text-white"},"Gjelder avviket for spesifikke stopp?"))),"line"===this.state.type&&this.state.chosenLine&&this.state.checkbox&&l.a.createElement("div",null,l.a.createElement(S.a,{isMulti:!0,placeholder:" ",onChange:this.handleChangeSpecifiedStops,options:this.returnSpecifiedLines()}),l.a.createElement("br",null)),"stop"===this.state.type&&this.state.stops&&l.a.createElement("div",null,l.a.createElement(S.a,{isMulti:!0,placeholder:"Velg stopp",onChange:this.handleChangeSpecifiedStops,options:this.returnMappedObjects(this.state.stops)}),l.a.createElement("br",null))),this.state.departure&&this.state.chosenLine&&l.a.createElement("div",null,l.a.createElement("br",null),l.a.createElement("p",{className:"text-center text-white"},"Gyldighetsdato"),l.a.createElement(x.a,{id:"date",name:"to",className:"form-control",options:{enableTime:!1,minDate:this.state.dateShort,dateFormat:"Y-m-d"}}),l.a.createElement("button",{onClick:this.callApiDeparture,type:"button",className:"btn btn-primary btn-lg btn-block"},"S\xf8k avganger")),this.state.departureSok&&this.state.chosenLine&&this.state.departures&&l.a.createElement("div",{className:"choose_type"},l.a.createElement("br",null),l.a.createElement("p",{className:"text-center text-white"},"Velg avgang"),l.a.createElement(S.a,{placeholder:" ",onChange:this.handleChangeDeparture,options:this.returnServiceJourney()})),this.state.departure&&this.state.message&&l.a.createElement("div",{className:"form-check d-flex"},l.a.createElement("label",{className:"form-check-label",htmlFor:"gridCheck2"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"gridCheck2",value:"stops",onChange:this.handleChangeSpecifyStopsDeparture}),l.a.createElement("p",{className:"text-center text-white"},"Gjelder avviket for spesifikke stopp?"))),this.state.departure&&this.state.checkbox2&&l.a.createElement("div",null,l.a.createElement(S.a,{isMulti:!0,placeholder:" ",onChange:this.handleChangeSpecifiedStopsDeparture,options:this.returnSpecifiedLinesDeparture()}),l.a.createElement("br",null)),this.state.dateFromTo&&l.a.createElement("div",{className:"bd-highlight justify-content-center"},l.a.createElement("p",{className:"text-center text-white"},"Gyldighetsdato"),l.a.createElement("div",{className:"form-group d-flex"},l.a.createElement(x.a,{"data-enable-time":!0,id:"from",value:this.state.dateShort,name:"from",onClose:this.updateFromDate,className:"date-form form-control",options:{enableTime:!0,dateFormat:"Y-m-d H:i",minDate:this.state.dateShort,time_24hr:!0}}),l.a.createElement(x.a,{id:"date-to","data-enable-time":!0,name:"to",placeholder:"Til-dato",className:"date-form form-control",options:{enableTime:!0,dateFormat:"Y-m-d H:i",minDate:this.state.from?this.state.from:this.state.dateShort,time_24hr:!0}}))),this.state.message&&l.a.createElement("div",null,l.a.createElement("div",{className:"severity&type"},l.a.createElement("p",{className:"text-center text-white"},"Rapporttype"),l.a.createElement("select",{className:"form-control",defaultValue:"incident",name:"ReportType"},l.a.createElement("option",{value:"incident"},"Incident"),l.a.createElement("option",{value:"general"},"General")),l.a.createElement("br",null)),l.a.createElement("div",{className:"message"},l.a.createElement("p",{className:"text-center text-white"},"Melding"),l.a.createElement("input",{type:"String",name:"oppsummering",className:"form-control",placeholder:"Kort, beskrivende avvikstekst",maxLength:"160",required:!0}),l.a.createElement("input",{type:"String",name:"beskrivelse",className:"form-control",placeholder:"Eventuell utdypende detaljer om avviket (ikke p\xe5krevd)"}),l.a.createElement("input",{type:"String",name:"forslag",className:"form-control",placeholder:"Beskrivelse om hva kunden skal/kan gj\xf8re (ikke p\xe5krevd)"}))),l.a.createElement("br",null),l.a.createElement("div",{className:"submit justify-content-center"},this.state.submit&&l.a.createElement(b.Button,{variant:"success",type:"submit",className:"btn btn-primary btn-lg btn-block"},"Registrer"),l.a.createElement(b.Button,{variant:"secondary",onClick:this.handleClick,type:"submit",className:"btn btn-warning btn-lg btn-block"},"Tilbake")))))}}]),t}(l.a.Component),O=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).state={id:a.props.match.params.deviationId,date:"",dateShort:""},a.handleSubmit=function(e){a.props.data.PtSituationElement[parseInt(a.state.id)].Progress="open",a.props.data.PtSituationElement[parseInt(a.state.id)].Summary._text=e.target.oppsummering.value,""!==e.target.beskrivelse.value?a.props.data.PtSituationElement[parseInt(a.state.id)].Description={_attributes:{"xml:lang":"NO"},_text:e.target.beskrivelse.value}:a.props.data.PtSituationElement[parseInt(a.state.id)].Description&&delete a.props.data.PtSituationElement[parseInt(a.state.id)].Description,""!==e.target.forslag.value?a.props.data.PtSituationElement[parseInt(a.state.id)].Advice={_attributes:{"xml:lang":"NO"},_text:e.target.forslag.value}:a.props.data.PtSituationElement[parseInt(a.state.id)].Advice&&delete a.props.data.PtSituationElement[parseInt(a.state.id)].Advice,e.target.from.value&&(a.props.data.PtSituationElement[parseInt(a.state.id)].ValidityPeriod.StartTime=e.target.from.value.replace(" ","T")+":00+02:00"),e.target.to.value&&(a.props.data.PtSituationElement[parseInt(a.state.id)].ValidityPeriod.EndTime=e.target.to.value.replace(" ","T")+":00+02:00"),a.props.data.PtSituationElement[parseInt(a.state.id)].ReportType=e.target.reportType.value,a.props.firebase.collection(a.props.organization).doc("Issues").set(a.props.data),a.props.history.push("/")},a.handleClick=function(){a.props.history.push("/")},a.setProgressToClosed=function(){a.props.data.PtSituationElement[parseInt(a.state.id)].Progress="closed",a.props.firebase.collection(a.props.organization).doc(a.props.docID).set(a.props.data),a.props.history.push("/")},a.checkStatus=function(e){return"open"===e?l.a.createElement("div",{className:"submit justify-content-center"},l.a.createElement("div",{className:"form-group d-flex"},l.a.createElement(b.Button,{variant:"negative",width:"fluid",onClick:a.setProgressToClosed,className:"p-2 btn "},"Deaktiver"),l.a.createElement(b.Button,{variant:"secondary",width:"fluid",type:"submit",className:"p-2 btn "},"Endre")),l.a.createElement(b.Button,{variant:"secondary",onClick:a.handleClick,type:"submit",className:"btn btn-warning btn-lg btn-block"},"Tilbake")):l.a.createElement("div",{className:"submit justify-content-center"},l.a.createElement(b.Button,{variant:"success",className:"btn btn-success btn-lg btn-block"},"Aktiver"),l.a.createElement(b.Button,{variant:"secondary",onClick:a.handleClick,type:"submit",className:"btn btn-warning btn-lg btn-block"},"Tilbake"))},a.returnValue=function(e){var t=a.props.data.PtSituationElement[parseInt(a.state.id)];return"ReportType"===e?t.ReportType:"summary"===e?t.Summary._text:"description"===e?t.Description?t.Description._text:"":"advice"===e?t.Advice?t.Advice._text:"":"from"===e?t.ValidityPeriod.StartTime.replace(":00+02:00",""):"to"===e?t.ValidityPeriod.EndTime?t.ValidityPeriod.EndTime.replace(":00+02:00",""):"Til-dato":"error"},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=(new Date).getDate();e<10&&(e="0"+e);var t=(new Date).getMonth()+1;t<10&&(t="0"+t);var a=(new Date).getFullYear(),n=(new Date).getHours();n<10&&(n="0"+n);var r=(new Date).getMinutes();r<10&&(r="0"+r);var i=(new Date).getSeconds();i<10&&(i="0"+i),this.setState({date:a+"-"+t+"-"+e+"T"+n+":"+r+":"+i+"+02:00",dateShort:a+"-"+t+"-"+e+"T"+n+":"+r})}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("div",{className:"register_box",id:"overview"},l.a.createElement("form",{className:"register",onSubmit:this.handleSubmit,autoComplete:"off"},l.a.createElement("br",null),l.a.createElement("h2",{className:"text-center text-white"},"Endre avvik"),l.a.createElement("br",null),l.a.createElement("div",{className:"severity"},l.a.createElement("p",{className:"text-center text-white"},"Rapporttype"),l.a.createElement("select",{className:"form-control",id:"cssmenu",defaultValue:this.returnValue("ReportType"),name:"reportType"},l.a.createElement("option",{value:"general"},"General"),l.a.createElement("option",{value:"incident"},"Incident")),l.a.createElement("br",null)),l.a.createElement("p",{id:"message",className:"text-center text-white"},"Melding"),l.a.createElement("input",{type:"String",name:"oppsummering",className:"form-control",defaultValue:this.returnValue("summary"),maxLength:"160",required:!0}),l.a.createElement("input",{type:"String",name:"beskrivelse",className:"form-control",defaultValue:this.returnValue("description")}),l.a.createElement("input",{type:"String",name:"forslag",className:"form-control",defaultValue:this.returnValue("advice")}),l.a.createElement("br",null),l.a.createElement("p",{className:"text-center text-white"},"Gyldighetsdato"),l.a.createElement("div",{className:"form-group d-flex"},l.a.createElement(x.a,{"data-enable-time":!0,value:this.returnValue("from"),name:"from",className:"date-form form-control",options:{enableTime:!0,dateFormat:"Y-m-d H:i",time_24hr:!0}}),l.a.createElement(x.a,{onChange:this.handleChangeDate,id:"date-to","data-enable-time":!0,placeholder:"Til-dato",value:this.returnValue("to"),name:"to",className:"date-form form-control",options:{enableTime:!0,minDate:this.state.dateShort,dateFormat:"Y-m-d H:i",time_24hr:!0}})),l.a.createElement("br",null),this.checkStatus(this.props.data.PtSituationElement[parseInt(this.state.id)].Progress))))}}]),t}(l.a.Component),P=a(54),j=a.n(P),I={};I.save=function(e){localStorage.setItem("OT::jwt",e)},I.get=function(){return localStorage.getItem("OT::jwt")},I.getBearer=function(){return"Bearer ".concat(I.get())};var A=I,L=function(){var e=new j.a("/key.json"),t={checkLoginIframe:!1};e.init(t).success(function(a){if(a){A.save(e.token),setInterval(function(){e.updateToken(60).error(function(){return e.logout()}),A.save(e.token)},1e4);var n={logoutUrl:e.createLogoutUrl(t),familyName:e.idTokenParsed.family_name,givenName:e.idTokenParsed.given_name,email:e.idTokenParsed.email,username:e.idTokenParsed.preferred_username,roles:e.tokenParsed.roles};q(n)}else e.login()})},R=a(55),V=a.n(R),z=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).handleChange=function(e){a.props.onSelectOrganization(e.value),a.props.history.push("/")},a.returnOptions=function(){for(var e=[],t=0;t<a.props.user.length;t++)e.push({label:a.props.name[t],value:a.props.user[t]});return e},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return l.a.createElement("nav",{className:"navBar"},l.a.createElement("div",{className:"padding"},l.a.createElement("a",{href:"/"},l.a.createElement("img",{src:V.a,width:126,height:54,alt:"Entur"})),l.a.createElement("div",{className:"select-organization"},l.a.createElement(S.a,{placeholder:this.props.name[0],onChange:this.handleChange,options:this.returnOptions()})),l.a.createElement("div",{className:"logout"},l.a.createElement("a",{href:this.props.logout},l.a.createElement("h6",{className:"text-center text-white"},"LOGG UT")))))}}]),t}(l.a.Component),_=a(56),F=a.n(_),B=a(240);a(243),B.initializeApp({apiKey:"AIzaSyCKcRzWRYlZkwG4I4WTTb2uRnI7VczCX5M",authDomain:"deviation-messages.firebaseapp.com",databaseURL:"https://deviation-messages.firebaseio.com",projectId:"deviation-messages",storageBucket:"deviation-messages.appspot.com",messagingSenderId:"132641363074",appId:"1:132641363074:web:1069e5f0a9717b4c"});var M=B.firestore(),J=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).state={data:"",organizations:[],organizationsName:[],selectedOrganization:"",lines:"",id:""},a.updateOrganization=function(e){a.setState({selectedOrganization:e},function(){return a.setDeviationsAndLines(e)})},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.setOrganizations()}},{key:"setOrganizations",value:function(){var e=this,t=this.props.userInfo.roles,a=[],n=[];t||(window.alert("You are not assigned to a company"),window.location.href=this.props.userInfo.logoutUrl);for(var r=0;r<t.length;r++)t[r].includes("editSX")&&a.push(t[r].split('"')[7]);w.getAuthorities().then(function(t){for(var r=t.data.authorities,i=0;i<a.length;i++)for(var o=0;o<r.length;o++)r[o].id.includes(a[i])&&(a[i]=r[o].id,n[i]=r[o].name);e.setState({organizations:a,organizationsName:n,selectedOrganization:a[0]},function(){return e.setDeviationsAndLines(e.state.organizations[0])})})}},{key:"setDeviationsAndLines",value:function(e){var t=this;M.collection(e).get().then(function(e){for(var a=0;a<e.docs.length;a++)"Issues"===e.docs[a].id&&(e.docs[a].data().PtSituationElement?t.setState({data:e.docs[a].data(),id:e.docs[a].id}):t.setState({data:{PtSituationElement:[]},id:e.docs[a].id}))}),w.getLines(e).then(function(e){console.log(e.data),e.data?t.setState({lines:e.data.lines}):console.log("Could not find any lines for this organization")})}},{key:"render",value:function(){var e=this;return l.a.createElement(m.a,null,l.a.createElement("div",null,l.a.createElement("img",{id:"background",src:F.a,alt:""}),l.a.createElement(p.a,{path:"/",render:function(t){return l.a.createElement(z,Object.assign({},t,{NavBar:!0,onSelectOrganization:e.updateOrganization,user:e.state.organizations,name:e.state.organizationsName,logout:e.props.userInfo.logoutUrl}))}}),l.a.createElement(p.a,{exact:!0,path:"/",render:function(t){return l.a.createElement(y,Object.assign({},t,{firebase:M,data:e.state.data}))}}),l.a.createElement(p.a,{path:"/edit/:deviationId?",render:function(t){return l.a.createElement(O,Object.assign({},t,{data:e.state.data,firebase:M,docID:e.state.id,organization:e.state.selectedOrganization}))}}),l.a.createElement(p.a,{path:"/register",render:function(t){return l.a.createElement(C,Object.assign({},t,{data:e.state.data,firebase:M,docID:e.state.id,lines:e.state.lines,organization:e.state.selectedOrganization}))}})))}}]),t}(l.a.Component);L();var q=t.default=function(e){d.a.render(l.a.createElement(J,{userInfo:e}),document.getElementById("root"))}},52:function(e,t,a){e.exports=a.p+"static/media/red.9980dfce.png"},53:function(e,t,a){e.exports=a.p+"static/media/green.fed131a5.png"},55:function(e,t,a){e.exports=a.p+"static/media/entur_logo.ed5eebce.jpg"},56:function(e,t,a){e.exports=a.p+"static/media/background.49ed55b2.jpg"},60:function(e,t,a){e.exports=a(249)},66:function(e,t,a){}},[[60,1,2]]]);
//# sourceMappingURL=main.13870cf0.chunk.js.map
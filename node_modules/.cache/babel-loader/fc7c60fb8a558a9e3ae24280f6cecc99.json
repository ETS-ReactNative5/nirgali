{"ast":null,"code":"import Keycloak from 'keycloak-js';\nconst keycloak_json = {\n  realm: 'rutebanken',\n  'auth-server-url': 'https://kc-dev.devstage.entur.io/auth',\n  'ssl-required': 'external',\n  resource: 'flexible-transport-frontend',\n  'public-client': true\n};\n\nconst initAuth = () => {\n  const kc = new Keycloak(keycloak_json);\n  const options = {\n    checkLoginIframe: false\n  };\n  kc.init(options).success(authenticated => {\n    if (authenticated) {\n      token.save(kc.token);\n      setInterval(() => {\n        kc.updateToken(minValiditySeconds).error(() => kc.logout());\n        token.save(kc.token);\n      }, refreshRateMs);\n      const userInfo = {\n        logoutUrl: kc.createLogoutUrl(options),\n        familyName: kc.idTokenParsed.family_name,\n        givenName: kc.idTokenParsed.given_name,\n        email: kc.idTokenParsed.email,\n        username: kc.idTokenParsed.preferred_username,\n        isAdmin: isAdmin(kc.tokenParsed)\n      };\n      renderIndex(userInfo);\n    } else {\n      kc.login();\n    }\n  });\n};\n\nexport default {\n  initAuth\n};","map":{"version":3,"sources":["/Users/Goplen/Desktop/knowit/3psx/src/auth.js"],"names":["Keycloak","keycloak_json","realm","resource","initAuth","kc","options","checkLoginIframe","init","success","authenticated","token","save","setInterval","updateToken","minValiditySeconds","error","logout","refreshRateMs","userInfo","logoutUrl","createLogoutUrl","familyName","idTokenParsed","family_name","givenName","given_name","email","username","preferred_username","isAdmin","tokenParsed","renderIndex","login"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,aAArB;AAEA,MAAMC,aAAa,GAAE;AACjBC,EAAAA,KAAK,EAAE,YADU;AAEjB,qBAAmB,uCAFF;AAGjB,kBAAgB,UAHC;AAIjBC,EAAAA,QAAQ,EAAE,6BAJO;AAKjB,mBAAiB;AALA,CAArB;;AAQA,MAAMC,QAAQ,GAAG,MAAM;AACnB,QAAMC,EAAE,GAAG,IAAIL,QAAJ,CAAaC,aAAb,CAAX;AACA,QAAMK,OAAO,GAAG;AAAEC,IAAAA,gBAAgB,EAAE;AAApB,GAAhB;AACAF,EAAAA,EAAE,CAACG,IAAH,CAAQF,OAAR,EAAiBG,OAAjB,CAAyBC,aAAa,IAAI;AACtC,QAAIA,aAAJ,EAAmB;AACfC,MAAAA,KAAK,CAACC,IAAN,CAAWP,EAAE,CAACM,KAAd;AACAE,MAAAA,WAAW,CAAC,MAAM;AACdR,QAAAA,EAAE,CAACS,WAAH,CAAeC,kBAAf,EAAmCC,KAAnC,CAAyC,MAAMX,EAAE,CAACY,MAAH,EAA/C;AACAN,QAAAA,KAAK,CAACC,IAAN,CAAWP,EAAE,CAACM,KAAd;AACH,OAHU,EAGRO,aAHQ,CAAX;AAIA,YAAMC,QAAQ,GAAG;AACbC,QAAAA,SAAS,EAAEf,EAAE,CAACgB,eAAH,CAAmBf,OAAnB,CADE;AAEbgB,QAAAA,UAAU,EAAEjB,EAAE,CAACkB,aAAH,CAAiBC,WAFhB;AAGbC,QAAAA,SAAS,EAAEpB,EAAE,CAACkB,aAAH,CAAiBG,UAHf;AAIbC,QAAAA,KAAK,EAAEtB,EAAE,CAACkB,aAAH,CAAiBI,KAJX;AAKbC,QAAAA,QAAQ,EAAEvB,EAAE,CAACkB,aAAH,CAAiBM,kBALd;AAMbC,QAAAA,OAAO,EAAEA,OAAO,CAACzB,EAAE,CAAC0B,WAAJ;AANH,OAAjB;AAQAC,MAAAA,WAAW,CAACb,QAAD,CAAX;AACH,KAfD,MAeO;AACHd,MAAAA,EAAE,CAAC4B,KAAH;AACH;AACJ,GAnBD;AAoBH,CAvBD;;AAyBA,eAAe;AAAE7B,EAAAA;AAAF,CAAf","sourcesContent":["import Keycloak from 'keycloak-js';\n\nconst keycloak_json ={\n    realm: 'rutebanken',\n    'auth-server-url': 'https://kc-dev.devstage.entur.io/auth',\n    'ssl-required': 'external',\n    resource: 'flexible-transport-frontend',\n    'public-client': true\n};\n\nconst initAuth = () => {\n    const kc = new Keycloak(keycloak_json);\n    const options = { checkLoginIframe: false };\n    kc.init(options).success(authenticated => {\n        if (authenticated) {\n            token.save(kc.token);\n            setInterval(() => {\n                kc.updateToken(minValiditySeconds).error(() => kc.logout());\n                token.save(kc.token);\n            }, refreshRateMs);\n            const userInfo = {\n                logoutUrl: kc.createLogoutUrl(options),\n                familyName: kc.idTokenParsed.family_name,\n                givenName: kc.idTokenParsed.given_name,\n                email: kc.idTokenParsed.email,\n                username: kc.idTokenParsed.preferred_username,\n                isAdmin: isAdmin(kc.tokenParsed)\n            };\n            renderIndex(userInfo);\n        } else {\n            kc.login();\n        }\n    });\n};\n\nexport default { initAuth }"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import Keycloak from 'keycloak-js';\nimport token from './token';\nimport renderIndex from '../index'; // Minimum number of seconds left of token before a refresh is needed\n\nconst minValiditySeconds = 60; // How often should lib check for valid token\n\nconst refreshRateMs = 10000;\n\nconst initAuth = () => {\n  const kc = new Keycloak('/key.json');\n  const options = {\n    checkLoginIframe: false\n  };\n  kc.init(options).success(authenticated => {\n    if (authenticated) {\n      token.save(kc.token);\n      setInterval(() => {\n        kc.updateToken(minValiditySeconds).error(() => kc.logout());\n        token.save(kc.token);\n      }, refreshRateMs);\n      const userInfo = {\n        logoutUrl: kc.createLogoutUrl(options),\n        familyName: kc.idTokenParsed.family_name,\n        givenName: kc.idTokenParsed.given_name,\n        email: kc.idTokenParsed.email,\n        username: kc.idTokenParsed.preferred_username,\n        id: kc.idTokenParsed.organisationID,\n        org: kc.idTokenParsed.o\n      };\n      renderIndex(userInfo);\n    } else {\n      kc.login();\n    }\n  });\n};\n\nexport default {\n  initAuth\n};","map":{"version":3,"sources":["/Users/Goplen/Desktop/knowit/3psx/src/authenticate/auth.js"],"names":["Keycloak","token","renderIndex","minValiditySeconds","refreshRateMs","initAuth","kc","options","checkLoginIframe","init","success","authenticated","save","setInterval","updateToken","error","logout","userInfo","logoutUrl","createLogoutUrl","familyName","idTokenParsed","family_name","givenName","given_name","email","username","preferred_username","id","organisationID","org","o","login"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,aAArB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,WAAP,MAAwB,UAAxB,C,CAEA;;AACA,MAAMC,kBAAkB,GAAG,EAA3B,C,CAEA;;AACA,MAAMC,aAAa,GAAG,KAAtB;;AAEA,MAAMC,QAAQ,GAAG,MAAM;AACnB,QAAMC,EAAE,GAAG,IAAIN,QAAJ,CAAa,WAAb,CAAX;AACA,QAAMO,OAAO,GAAG;AAAEC,IAAAA,gBAAgB,EAAE;AAApB,GAAhB;AACAF,EAAAA,EAAE,CAACG,IAAH,CAAQF,OAAR,EAAiBG,OAAjB,CAAyBC,aAAa,IAAI;AACtC,QAAIA,aAAJ,EAAmB;AACfV,MAAAA,KAAK,CAACW,IAAN,CAAWN,EAAE,CAACL,KAAd;AACAY,MAAAA,WAAW,CAAC,MAAM;AACdP,QAAAA,EAAE,CAACQ,WAAH,CAAeX,kBAAf,EAAmCY,KAAnC,CAAyC,MAAMT,EAAE,CAACU,MAAH,EAA/C;AACAf,QAAAA,KAAK,CAACW,IAAN,CAAWN,EAAE,CAACL,KAAd;AACH,OAHU,EAGRG,aAHQ,CAAX;AAIA,YAAMa,QAAQ,GAAG;AACbC,QAAAA,SAAS,EAAEZ,EAAE,CAACa,eAAH,CAAmBZ,OAAnB,CADE;AAEba,QAAAA,UAAU,EAAEd,EAAE,CAACe,aAAH,CAAiBC,WAFhB;AAGbC,QAAAA,SAAS,EAAEjB,EAAE,CAACe,aAAH,CAAiBG,UAHf;AAIbC,QAAAA,KAAK,EAAEnB,EAAE,CAACe,aAAH,CAAiBI,KAJX;AAKbC,QAAAA,QAAQ,EAAEpB,EAAE,CAACe,aAAH,CAAiBM,kBALd;AAMbC,QAAAA,EAAE,EAAEtB,EAAE,CAACe,aAAH,CAAiBQ,cANR;AAObC,QAAAA,GAAG,EAAExB,EAAE,CAACe,aAAH,CAAiBU;AAPT,OAAjB;AASA7B,MAAAA,WAAW,CAACe,QAAD,CAAX;AACH,KAhBD,MAgBO;AACHX,MAAAA,EAAE,CAAC0B,KAAH;AACH;AACJ,GApBD;AAqBH,CAxBD;;AA0BA,eAAe;AAAE3B,EAAAA;AAAF,CAAf","sourcesContent":["import Keycloak from 'keycloak-js';\nimport token from './token';\nimport renderIndex from '../index'\n\n// Minimum number of seconds left of token before a refresh is needed\nconst minValiditySeconds = 60;\n\n// How often should lib check for valid token\nconst refreshRateMs = 10000;\n\nconst initAuth = () => {\n    const kc = new Keycloak('/key.json');\n    const options = { checkLoginIframe: false };\n    kc.init(options).success(authenticated => {\n        if (authenticated) {\n            token.save(kc.token);\n            setInterval(() => {\n                kc.updateToken(minValiditySeconds).error(() => kc.logout());\n                token.save(kc.token);\n            }, refreshRateMs);\n            const userInfo = {\n                logoutUrl: kc.createLogoutUrl(options),\n                familyName: kc.idTokenParsed.family_name,\n                givenName: kc.idTokenParsed.given_name,\n                email: kc.idTokenParsed.email,\n                username: kc.idTokenParsed.preferred_username,\n                id: kc.idTokenParsed.organisationID,\n                org: kc.idTokenParsed.o,\n            };\n            renderIndex(userInfo);\n        } else {\n            kc.login();\n        }\n    });\n};\n\nexport default { initAuth }"]},"metadata":{},"sourceType":"module"}